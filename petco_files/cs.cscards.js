var CSCards=CSCards||{};CSCards.cards={_attributes:{savedCardsElement:$('#saved-cards'),newCardElement:$('#new-card'),cardNumber:$('#cardNumber'),cardType:$('#cardType'),expiryMonth:$('#ExpiryMonth'),expiryYear:$('#ExpiryYear'),nameOnCard:$('#nameOnCard'),SaveCardCheckBox:$('#SaveDetails'),paymentId:$('#paymentId'),paymentSaveForm:$('#paymentSaveForm'),paymentCardForm:$('#paymentCardForm'),loadSavedCardsUrl:ACC.config.contextPath+"/checkout/multi/cybersource-payment-method/cards/list"},bindAll:function(){this._bindLoadSavedCreditCards();this._clearAllElementsInCards();this._bindPaymentBlockButton();},_bindPaymentCardListeners:function(){},_bindPaymentBlockButton:function()
{$("#lastInTheForm123").on("click",function(e)
{ACC.common.blockFormAndShowProcessingMessage($(this));});},_trackPaymentIdForUserChange:function(){this._attributes.paymentId.val('');},_bindLoadSavedCreditCards:function(){this._attributes.savedCardsElement.click(this._displaySavedCardsOnColorBox);this._attributes.newCardElement.click(this._clearAllElementsInCards);},_clearAllElementsInCards:function(){CSCards.cards._attributes.paymentId.val('');CSCards.cards._attributes.cardType.val('');CSCards.cards._attributes.cardNumber.val('');CSCards.cards._attributes.expiryMonth.val('');CSCards.cards._attributes.expiryYear.val('');CSCards.cards._attributes.nameOnCard.val('');var _event=jQuery.Event("change");CSCards.cards._attributes.cardType.trigger(_event);CSCards.cards._attributes.SaveCardCheckBox.attr("checked",false);CSCards.cards._attributes.paymentSaveForm.removeClass("disabledDiv");CSCards.cards._attributes.paymentCardForm.removeClass("disabledDiv");CSCards.cards._attributes.newCardElement.hide();CSCards.cards._attributes.savedCardsElement.show();},_displaySavedCardsOnColorBox:function(){$.ajax({type:'GET',url:CSCards.cards._attributes.loadSavedCardsUrl}).done(function(savedCardsList){savedCardsList['csrfToken']=ACC.config.CSRFToken;CSCards.cards._displayCards(savedCardsList);}).fail(function(){console.log('error while trying to get the cards associated with the customer');});},_displayCards:function(cards){var htmlToShow=null;if(cards.error){htmlToShow="<h1 class='error-message'>"+cards.errorMessage+"</h1>";}else{htmlToShow=$('#existing-cards-template').tmpl(cards)[0].outerHTML;}
$.colorbox({html:htmlToShow,height:false});},_useCard:function(component){var _selectedPaymentInfo=$(component).data('pi-id');var _cardType=$(component).data('pi-card-type');var _cardNumber=$(component).data('pi-card-number');var _expiryMonth=parseInt($(component).data('pi-expiry-month'));var _expiryYear=$(component).data('pi-expiry-year');var _accountHolderName=$(component).data('pi-account-holder-name');this._attributes.paymentId.val(_selectedPaymentInfo);this._attributes.cardType.val(_cardType);var _event=jQuery.Event("change");this._attributes.cardType.trigger(_event);this._attributes.cardNumber.val(_cardNumber);this._attributes.expiryMonth.val(_expiryMonth);this._attributes.expiryYear.val(_expiryYear);this._attributes.nameOnCard.val(_accountHolderName);this._attributes.SaveCardCheckBox.attr("checked",false);this._attributes.newCardElement.show();this._attributes.savedCardsElement.hide();this._attributes.paymentSaveForm.addClass("disabledDiv");this._attributes.paymentCardForm.addClass("disabledDiv");$(window).colorbox.close();}};$(document).ready(function(){CSCards.cards.bindAll();});